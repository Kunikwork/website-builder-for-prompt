<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Website Builder</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Source+Code+Pro:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* Base styles from index.txt */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: linear-gradient(135deg, #1a1c20, #24262b, #1d1f23);
            color: #f5f5f5;
            font-family: 'Poppins', 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            padding: 15px;
            background-attachment: fixed;
        }
        /* Weather animations */
        .weather-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        @keyframes rain { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } }
        .weather-rain { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="100" viewBox="0 0 20 100"><line x1="10" y1="0" x2="10" y2="100" stroke="rgba(148, 163, 184, 0.1)" stroke-width="1"/></svg>'); background-size: 20px 100px; animation: rain 1s linear infinite; opacity: 0.5; }
        .weather-snow { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><circle cx="20" cy="20" r="1.5" fill="rgba(200, 200, 255, 0.2)"/></svg>'); background-size: 40px 40px; animation: snow 10s linear infinite; opacity: 0.5; }
        .weather-wind { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="20" viewBox="0 0 100 20"><path d="M0,10 Q25,5 50,10 T100,10" stroke="rgba(148, 163, 184, 0.1)" stroke-width="1" fill="none"/></svg>'); background-size: 100px 20px; animation: wind 5s linear infinite; opacity: 0.3; }
        .weather-sunny { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 10% 20%, rgba(251, 191, 36, 0.05) 0%, transparent 20%), radial-gradient(circle at 90% 80%, rgba(245, 158, 11, 0.05) 0%, transparent 20%); opacity: 0.2; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 15px; position: relative; z-index: 10; }
        header { text-align: center; margin-bottom: 12px; padding: 15px 20px; background: rgba(20, 20, 30, 0.25); border-radius: 20px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden; animation: fadeIn 0.8s ease-out; transition: all 0.4s ease; }
        header:hover { transform: translateY(-5px); box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; border-radius: 20px; background: linear-gradient(45deg, #8a2be2, #ff00ff, #4a90e2, #8a2be2) border-box; -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0); -webkit-mask-composite: destination-out; mask-composite: exclude; z-index: -1; animation: borderAnimation 15s ease infinite; background-size: 300% 300%; }
        @keyframes borderAnimation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        h1 { font-size: 3.2rem; margin-bottom: 8px; font-weight: 700; background: linear-gradient(90deg, #f5f5f5, #d4d4d4); -webkit-background-clip: text; background-clip: text; color: transparent; letter-spacing: -0.5px; text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        #greeting { font-size: 2.2rem; margin-bottom: 8px; font-weight: 400; color: #d4d4d4; min-height: 2.5rem; display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 0.5rem; }
        .name-gradient { background: linear-gradient(90deg, #8a2be2, #ff00ff, #4a90e2); -webkit-background-clip: text; background-clip: text; color: transparent; font-weight: 600; animation: gradientAnimation 12s ease infinite; background-size: 300% 300%; }
        @keyframes gradientAnimation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .subtitle { font-size: 1.3rem; max-width: 90%; margin: 0 auto; color: #d4d4d4; font-weight: 300; line-height: 1.6; background: rgba(0, 0, 0, 0.2); padding: 10px 15px; border-radius: 15px; backdrop-filter: blur(5px); border: 1px solid rgba(255, 255, 255, 0.05); }
        
        .how-to-use { background: rgba(20, 20, 30, 0.25); border-radius: 20px; padding: 15px; margin-bottom: 12px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); position: relative; animation: slideUp 0.8s ease-out; transition: all 0.4s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .how-to-use-title { font-size: 1.5rem; font-weight: 600; color: #f5f5f5; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .how-to-use-title i { color: #8a2be2; font-size: 1.3rem; }
        .how-to-use-steps { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px; }
        .step { background: rgba(10, 10, 20, 0.3); border-radius: 12px; padding: 12px; display: flex; align-items: flex-start; gap: 10px; }
        .step-number { background: linear-gradient(45deg, #8a2be2, #ff00ff); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; flex-shrink: 0; }
        .step-content { font-size: 0.95rem; line-height: 1.4; }
        .step-highlight { color: #4a90e2; font-weight: 500; }
        .ai-model-link { color: #8a2be2; font-weight: 500; text-decoration: none; cursor: pointer; }

        .prompt-container { background: rgba(20, 20, 30, 0.25); border-radius: 20px; padding: 15px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); position: relative; margin-bottom: 15px; animation: slideUp 0.8s ease-out; transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1); max-height: 450px; display: flex; flex-direction: column; }
        .prompt-container.expanded { max-height: calc(100vh - 100px) !important; }
        .prompt-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); flex-wrap: wrap; gap: 10px; }
        .prompt-title { font-size: 1.8rem; font-weight: 600; color: #f5f5f5; display: flex; align-items: center; gap: 12px; }
        .prompt-title i { color: #8a2be2; font-size: 1.5rem; }
        .action-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        #copy-button, #copy-html-button, #preview-button { background: linear-gradient(90deg, #8a2be2, #ff00ff, #4a90e2); background-size: 300% 300%; color: white; border: none; padding: 10px 20px; border-radius: 50px; font-size: 1.1rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3); animation: gradientAnimation 12s ease infinite; }
        #copy-button.copied, #copy-html-button.copied, #preview-button:hover { background: linear-gradient(45deg, #4CAF50, #2E7D32); animation: none; }
        #preview-button { background: #2196F3; }
        #preview-button:hover { background: #1e88e5; }
        
        #prompt-text { background: rgba(10, 10, 20, 0.3); border-radius: 16px; padding: 15px; overflow-y: auto; font-family: 'Source Code Pro', monospace; font-size: 1.05rem; line-height: 1.8; color: #f0f0f0; border: 1px solid rgba(255, 255, 255, 0.05); white-space: pre-wrap; backdrop-filter: blur(5px); flex: 1; min-height: 200px; }
        
        [contenteditable="true"] { outline: 2px dashed rgba(74, 144, 226, 0.5); padding: 5px; border-radius: 5px; transition: outline 0.3s ease; }
        [contenteditable="true"]:focus { outline: 2px solid rgba(74, 144, 226, 1); }
        .editor-toolbar { background: rgba(10, 10, 20, 0.5); padding: 8px; border-radius: 10px; margin-bottom: 10px; display: flex; gap: 5px; flex-wrap: wrap; align-items: center; }
        .toolbar-button { background: #4a90e2; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 0.9rem; }
        .toolbar-button:hover { background: #3a80d2; }
        .color-picker-wrapper { position: relative; }
        #color-picker { position: absolute; top: -1000px; left: -1000px; opacity: 0; } /* Hide the actual input */

        .copy-feedback { position: fixed; bottom: 20px; right: 20px; background: linear-gradient(45deg, #4CAF50, #2E7D32); color: white; padding: 12px 20px; border-radius: 50px; font-weight: 500; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); z-index: 1000; transform: translateY(100px); opacity: 0; transition: all 0.3s ease; }
        .copy-feedback.show { transform: translateY(0); opacity: 1; }
        
        @media (max-width: 992px) { .how-to-use-steps { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { h1 { font-size: 2.4rem; } #greeting { font-size: 1.8rem; } .prompt-header { flex-direction: column; gap: 15px; text-align: center; } .action-buttons { width: 100%; justify-content: center; } }
        .loader { display: inline-block; margin-left: 10px; }
        .loader::after { content: ""; display: inline-block; width: 12px; height: 12px; border-radius: 50%; border: 2px solid #f5f5f5; border-color: #f5f5f5 transparent #f5f5f5 transparent; animation: loader 1.2s linear infinite; }
        @keyframes loader { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="weather-animation">
        <div class="weather-rain"></div><div class="weather-snow"></div><div class="weather-wind"></div><div class="weather-sunny"></div>
    </div>
    
    <div class="container">
        <header>
            <h1 id="main-title" contenteditable="true">Conversion Booster</h1>
            <div id="greeting">Hello<span class="loader"></span></div>
            <p id="main-subtitle" class="subtitle" contenteditable="true">Deliver ruthless, tactical, high-clarity CRO audits for any public-facing website</p>
        </header>
        
        <div class="how-to-use">
            <h2 class="how-to-use-title"><i class="fas fa-lightbulb"></i> How to Use This Prompt</h2>
            <div class="how-to-use-steps">
                <div class="step"><div class="step-number">1</div><div class="step-content">Copy the prompt using the <span class="step-highlight">Copy Prompt</span> button</div></div>
                <div class="step"><div class="step-number">2</div><div class="step-content">Run it in a reasoning model (<span id="ai-model" class="ai-model-link"></span>)</div></div>
                <div class="step"><div class="step-number">3</div><div class="step-content">Enable <span id="ai-mode" class="step-highlight"></span> feature</div></div>
                <div class="step"><div class="step-number">4</div><div id="step-4-text" class="step-content" contenteditable="true">Paste your website URL and other requested details</div></div>
            </div>
        </div>
        
        <main>
            <div class="prompt-container" id="prompt-container">
                <div class="prompt-header">
                    <h2 class="prompt-title"><i class="fas fa-chart-line"></i> <span id="prompt-main-title" contenteditable="true">Ultimate CRO Analysis Prompt</span></h2>
                    <div class="action-buttons">
                        <button id="preview-button"><i class="fas fa-eye"></i> Preview</button>
                        <button id="copy-button"><i class="fas fa-copy"></i> Copy Prompt</button>
                        <button id="copy-html-button"><i class="fas fa-code"></i> Get HTML File</button>
                    </div>
                </div>
                <div class="editor-toolbar">
                    <button class="toolbar-button" data-command="bold" title="Bold"><i class="fas fa-bold"></i></button>
                    <button class="toolbar-button" data-command="italic" title="Italic"><i class="fas fa-italic"></i></button>
                    <button class="toolbar-button" data-command="underline" title="Underline"><i class="fas fa-underline"></i></button>
                    <button class="toolbar-button" data-command="insertUnorderedList" title="Bulleted List"><i class="fas fa-list-ul"></i></button>
                    <button class="toolbar-button" data-command="insertOrderedList" title="Numbered List"><i class="fas fa-list-ol"></i></button>
                    <div class="color-picker-wrapper">
                        <button class="toolbar-button" id="color-button" title="Text Color"><i class="fas fa-palette"></i></button>
                        <input type="color" id="color-picker">
                    </div>
                </div>
                <div id="prompt-text" contenteditable="true"></div>
            </div>
        </main>
    </div>
    
    <div id="copy-feedback" class="copy-feedback"><i class="fas fa-check-circle"></i> Copied to clipboard!</div>
    
    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            // --- DATA & CONFIG ---
            const aiModels = [
                { name: 'Z.ai', mode: 'Auto Think + Web Search', url: 'https://chat.z.ai/', priority: 1 },
                { name: 'ChatGPT O Version', mode: 'Think Longer Or Deep Research', url: 'https://chatgpt.com/', priority: 1 },
                { name: 'Perplexity', mode: '', url: 'https://www.perplexity.ai/', priority: 1 },
                { name: 'Gemini Pro Version', mode: '', url: 'https://gemini.google.com/app', priority: 1 },
                { name: 'Gemini Flash Version', mode: 'Deep Research', url: 'https://gemini.google.com/app', priority: 2 },
                { name: 'Claud', mode: 'Extended Thinking', url: 'https://claude.ai/new', priority: 2 },
                { name: 'DeepSeek', mode: 'DeepThink + Search', url: 'https://chat.deepseek.com/', priority: 2 },
                { name: 'Qwen', mode: 'Thinking + Search', url: 'https://chat.qwen.ai/', priority: 2 }
            ];
            
            const initialPromptContent = `... a lot of content ...`; // Keeping it short for brevity

            // --- DOM ELEMENTS ---
            const promptTextEl = document.getElementById('prompt-text');
            
            // --- FUNCTIONS ---
            function getQueryParam(key) { return new URLSearchParams(window.location.search).get(key); }
            function getGreeting(hour) { if (hour >= 5 && hour < 12) return "Good Morning"; if (hour >= 12 && hour < 17) return "Good Afternoon"; if (hour >= 17 && hour < 22) return "Good Evening"; return "Hello"; }
            function showCopyFeedback(message = "Copied to clipboard!") { const feedback = document.getElementById('copy-feedback'); feedback.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`; feedback.classList.add('show'); setTimeout(() => { feedback.classList.remove('show'); }, 2000); }
            
            function setInitialPrompt() {
                promptTextEl.innerHTML = `
                <span class="prompt-section">CONVERSION BOOSTER - ULTIMATE CRO ANALYSIS PROMPT</span><br><br>
                <span class="prompt-subsection">INITIAL USER REQUEST CHECK</span><br>
                First, check if the user has provided a website URL in their message. <br>
                - If the user has not provided a website URL, respond ONLY with: "To begin your comprehensive CRO analysis, please provide the following details..."<br>
                - If the user has provided a website URL, immediately proceed with all phases of the CRO analysis.<br><br>
                <span class="prompt-subsection">MANDATORY EXECUTION RULES:</span><br>
                - Execute ALL phases (1 through 8) in numerical order without stopping.<br>
                - Use placeholder or simulated metrics where the user has not provided specific data.<br><br>
                <span class="prompt-highlight">This is a highlighted section.</span> You can edit this text.`;
            }

            function getRandomAIModel() {
                const priority1 = aiModels.filter(model => model.priority === 1);
                const priority2 = aiModels.filter(model => model.priority === 2);
                const usePriority1 = Math.random() < 0.7;
                const modelsToChooseFrom = usePriority1 && priority1.length > 0 ? priority1 : priority2;
                return modelsToChooseFrom[Math.floor(Math.random() * modelsToChooseFrom.length)];
            }

            function updateAIModelInfo() {
                const selectedModel = getRandomAIModel();
                document.getElementById('ai-model').textContent = selectedModel.name;
                document.getElementById('ai-mode').textContent = selectedModel.mode || 'Deep Research';
            }
            
            function setupToolbar() {
                const toolbar = document.querySelector('.editor-toolbar');
                toolbar.addEventListener('click', function(e) {
                    const button = e.target.closest('.toolbar-button');
                    if (!button) return;
                    const command = button.dataset.command;
                    if (command) {
                        e.preventDefault();
                        document.execCommand(command, false, null);
                        promptTextEl.focus();
                    }
                });

                const colorButton = document.getElementById('color-button');
                const colorPicker = document.getElementById('color-picker');
                colorButton.addEventListener('click', () => colorPicker.click());
                colorPicker.addEventListener('input', (e) => {
                    document.execCommand('foreColor', false, e.target.value);
                });
            }

            function generateFinalHTML() {
                const editedTitle = document.getElementById('main-title').innerText;
                const editedSubtitle = document.getElementById('main-subtitle').innerText;
                const editedStep4 = document.getElementById('step-4-text').innerText;
                const editedPromptTitle = document.getElementById('prompt-main-title').innerText;
                const editedPromptContent = document.getElementById('prompt-text').innerHTML.replace(/`/g, '\\`');

                // This is the clean template for the final output file
                return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${editedTitle}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Source+Code+Pro:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* All the final page styles from index.txt go here */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: linear-gradient(135deg, #1a1c20, #24262b, #1d1f23); color: #f5f5f5; font-family: 'Poppins', sans-serif; line-height: 1.6; min-height: 100vh; position: relative; overflow-x: hidden; padding: 15px; background-attachment: fixed; }
        .weather-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        @keyframes rain { 0% { background-position: 0 0; } 100% { background-position: 0 100%; } }
        .weather-rain { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="100" viewBox="0 0 20 100"><line x1="10" y1="0" x2="10" y2="100" stroke="rgba(148, 163, 184, 0.1)" stroke-width="1"/></svg>'); background-size: 20px 100px; animation: rain 1s linear infinite; opacity: 0.5; }
        .container { max-width: 1400px; margin: 0 auto; padding: 15px; position: relative; z-index: 10; }
        header { text-align: center; margin-bottom: 12px; padding: 15px 20px; background: rgba(20, 20, 30, 0.25); border-radius: 20px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden; }
        header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; border-radius: 20px; background: linear-gradient(45deg, #8a2be2, #ff00ff, #4a90e2, #8a2be2) border-box; -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0); -webkit-mask-composite: destination-out; mask-composite: exclude; z-index: -1; animation: borderAnimation 15s ease infinite; background-size: 300% 300%; }
        @keyframes borderAnimation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        h1 { font-size: 3.2rem; margin-bottom: 8px; font-weight: 700; background: linear-gradient(90deg, #f5f5f5, #d4d4d4); -webkit-background-clip: text; background-clip: text; color: transparent; }
        #greeting { font-size: 2.2rem; margin-bottom: 8px; font-weight: 400; color: #d4d4d4; }
        .name-gradient { background: linear-gradient(90deg, #8a2be2, #ff00ff, #4a90e2); -webkit-background-clip: text; background-clip: text; color: transparent; font-weight: 600; animation: gradientAnimation 12s ease infinite; background-size: 300% 300%; }
        @keyframes gradientAnimation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .subtitle { font-size: 1.3rem; max-width: 90%; margin: 0 auto; color: #d4d4d4; background: rgba(0, 0, 0, 0.2); padding: 10px 15px; border-radius: 15px; }
        .how-to-use { background: rgba(20, 20, 30, 0.25); border-radius: 20px; padding: 15px; margin-bottom: 12px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .how-to-use-title { font-size: 1.5rem; font-weight: 600; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .how-to-use-title i { color: #8a2be2; }
        .how-to-use-steps { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px; }
        .step { background: rgba(10, 10, 20, 0.3); border-radius: 12px; padding: 12px; display: flex; align-items: flex-start; gap: 10px; }
        .step-number { background: linear-gradient(45deg, #8a2be2, #ff00ff); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; flex-shrink: 0; }
        .step-content { font-size: 0.95rem; }
        .step-highlight { color: #4a90e2; font-weight: 500; }
        .ai-model-link { color: #8a2be2; font-weight: 500; text-decoration: none; cursor: pointer; }
        .prompt-container { background: rgba(20, 20, 30, 0.25); border-radius: 20px; padding: 15px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .prompt-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .prompt-title { font-size: 1.8rem; font-weight: 600; display: flex; align-items: center; gap: 12px; }
        .prompt-title i { color: #8a2be2; }
        #copy-button { background: linear-gradient(90deg, #8a2be2, #ff00ff, #4a90e2); color: white; border: none; padding: 10px 20px; border-radius: 50px; font-size: 1.1rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        #prompt-text { background: rgba(10, 10, 20, 0.3); border-radius: 16px; padding: 15px; overflow-y: auto; font-family: 'Source Code Pro', monospace; font-size: 1.05rem; color: #f0f0f0; white-space: pre-wrap; }
        .copy-feedback { position: fixed; bottom: 20px; right: 20px; background: #4CAF50; color: white; padding: 12px 20px; border-radius: 50px; z-index: 1000; opacity: 0; transition: opacity 0.3s; }
        .copy-feedback.show { opacity: 1; }
    </style>
</head>
<body>
    <div class="weather-animation"><div class="weather-rain"></div></div>
    <div class="container">
        <header>
            <h1>${editedTitle}</h1>
            <div id="greeting"></div>
            <p class="subtitle">${editedSubtitle}</p>
        </header>
        <div class="how-to-use">
            <h2 class="how-to-use-title"><i class="fas fa-lightbulb"></i> How to Use This Prompt</h2>
            <div class="how-to-use-steps">
                <div class="step"><div class="step-number">1</div><div class="step-content">Copy the prompt using the <span class="step-highlight">Copy Prompt</span> button</div></div>
                <div class="step"><div class="step-number">2</div><div class="step-content">Run it in a reasoning model (<span id="ai-model" class="ai-model-link"></span>)</div></div>
                <div class="step"><div class="step-number">3</div><div class="step-content">Enable <span id="ai-mode" class="step-highlight"></span> feature</div></div>
                <div class="step"><div class="step-number">4</div><div class="step-content">${editedStep4}</div></div>
            </div>
        </div>
        <main>
            <div class="prompt-container">
                <div class="prompt-header">
                    <h2 class="prompt-title"><i class="fas fa-chart-line"></i> ${editedPromptTitle}</h2>
                    <button id="copy-button"><i class="fas fa-copy"></i> Copy Prompt</button>
                </div>
                <div id="prompt-text">${editedPromptContent}</div>
            </div>
        </main>
    </div>
    <div id="copy-feedback" class="copy-feedback"><i class="fas fa-check-circle"></i> Copied!</div>
    <script>
        // All the final page JS from index.txt goes here
        document.addEventListener("DOMContentLoaded", function() {
            const aiModels = ${JSON.stringify(aiModels)};
            function getQueryParam(key) { return new URLSearchParams(window.location.search).get(key); }
            function getGreeting(hour) { if (hour >= 5 && hour < 12) return "Good Morning"; if (hour >= 12 && hour < 17) return "Good Afternoon"; return "Good Evening"; }
            function showCopyFeedback() { const feedback = document.getElementById('copy-feedback'); feedback.classList.add('show'); setTimeout(() => { feedback.classList.remove('show'); }, 2000); }
            
            document.getElementById('copy-button').addEventListener('click', () => {
                navigator.clipboard.writeText(document.getElementById('prompt-text').innerText).then(showCopyFeedback);
            });

            function updateAIModelInfo() {
                const selectedModel = aiModels[Math.floor(Math.random() * aiModels.length)];
                document.getElementById('ai-model').textContent = selectedModel.name;
                document.getElementById('ai-mode').textContent = selectedModel.mode || 'Deep Research';
            }

            const name = getQueryParam("name");
            const greeting = getGreeting(new Date().getHours());
            document.getElementById("greeting").innerHTML = name ? \`\${greeting}, <span class="name-gradient">\${name}</span>\` : greeting;
            
            document.querySelector('.weather-rain').style.display = 'block';
            updateAIModelInfo();
            setInterval(updateAIModelInfo, 10000);
        });
    <\/script>
</body>
</html>`;
            }
            
            // --- EVENT LISTENERS ---
            document.getElementById('copy-button').addEventListener('click', () => {
                navigator.clipboard.writeText(promptTextEl.innerText).then(() => showCopyFeedback("Prompt copied!"));
            });

            document.getElementById('copy-html-button').addEventListener('click', () => {
                const finalHtml = generateFinalHTML();
                const blob = new Blob([finalHtml], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'index.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showCopyFeedback("index.html file generated!");
            });

            document.getElementById('preview-button').addEventListener('click', () => {
                const finalHtml = generateFinalHTML();
                const newWindow = window.open();
                newWindow.document.write(finalHtml);
                newWindow.document.close();
            });

            // --- INITIALIZATION ---
            setInitialPrompt();
            updateAIModelInfo();
            setInterval(updateAIModelInfo, 10000); // Refresh AI model every 10 seconds
            setupToolbar();

            const name = getQueryParam("name");
            const greeting = getGreeting(new Date().getHours());
            const greetingElement = document.getElementById("greeting");
            if (name) {
                greetingElement.innerHTML = `${greeting}, <span class="name-gradient">${name}</span>`;
            } else {
                greetingElement.innerHTML = `${greeting}`;
            }
            greetingElement.querySelector('.loader')?.remove();

            const animations = ['weather-rain', 'weather-snow', 'weather-wind', 'weather-sunny'];
            const selectedAnimation = animations[Math.floor(Math.random() * animations.length)];
            document.querySelector(`.${selectedAnimation}`).style.display = 'block';

            // Animated favicon logic from index.txt
            const canvas = document.createElement('canvas');
            canvas.width = 32; canvas.height = 32;
            const ctx = canvas.getContext('2d');
            function drawFavicon(phase) {
                ctx.clearRect(0, 0, 32, 32);
                const t = (Math.sin(phase) + 1) / 2;
                const hue = 320 * (1 - t) + 210 * t;
                ctx.font = '32px serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = `hsl(${hue}, 100%, 70%)`;
                ctx.fillText('✦', 16, 18);
            }
            function setFavicon() {
                const old = document.getElementById('favicon');
                if (old) old.remove();
                const link = document.createElement('link');
                link.id = 'favicon';
                link.rel = 'icon';
                link.href = canvas.toDataURL('image/png');
                document.head.appendChild(link);
            }
            function animate(time) {
                drawFavicon(time / 3000);
                setFavicon();
                requestAnimationFrame(animate);
            }
            requestAnimationFrame(animate);
        });
    </script>
</body>
</html>
